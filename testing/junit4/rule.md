JUnit4 rule предоставляет механизм для расширения теста с помощью запуска кода вокруг самого теста, механизм похож на @Before/@After методы.
Для использования rule'ов нужно создать public поле типа реализующего интерфейс TestRule и добавить на него аннотацию @Rule.

Предоставляемые JUnit:
- TemporaryFolder
	Позволяет создать временные папки и файлы, которые требуется удалить после выполнения теста
	![[TemporaryFolder rule.png]]
	Однако rule не проверяет удаление папки/файла после теста, но такая поддержка была добавлена в версии 4.13:
	![[TemporaryFolder assureDeletion.png]]

- ExpectedException
	Используется для того чтобы проверить что тест выбрасывает указанный exception
	![[ExpectedException rule.png]]
	Если исключение не выбрасывается, то тест проваливает, эквивалетно заданию параметра expected в @Test.

- TestName
	Позволяет получить имя тестого метода внутри него
	![[TestName rule.png]]

- Timeout
	С помощью него можно задать время по истечению которого тест будет провальным (аналогично параметру "timeout" в @Test, но действует на все тесты сразу)
	![[Timeout rule.png]]

- ErrorCollector
	Дает возможность выполнять тест дальше при возникновении проблем и после завершения выводит все сразу
	![[ErrorCollector rule.png]]

- Verifier
	Это абстрактный класс, позволяющий переопределить метод "verify" и задать в нем параметры для сравнения, которые будут применяться в тестах
	![[Verifier rule.png]]

- Disable on debug
	Позволяет задать rule внутри обертки и если тест запущен в debug'е, то rule выполняться не будет
	![[Disable on debug rule.png]]

- ExternalResource
 Абстрактный класс, в котором нужно переопределить методы "before" и "after" для конфигурации и удаления ресурсов. TemporaryFolder наследует ExternalResource.
 ![[ExternalResource rule.png]]

Для применения rule не к метод, а к классу используется аннотация @ClassRule. Поле к которому применяется аннотация должно быть статическим.
![[@ClassRule usage.png]]

Чтобы создать собственный rule нужно реализовать интерфейс TestRule и переопределить метод apply(Statement, Description)
![[custom rule.png]]
Метод должен возвращать Statement - тест внутри JUnit runtime. При вызове evaluate(), будет запускаться выполнение теста.

Чтобы задать цепочку rule'ов можно применить RuleChain и с помощью метода "around" задать последующие rule'ы.
![[RuleChain.png]]